unbind -a
unbind -T root -a
unbind -T copy-mode -a
unbind -T copy-mode-vi -a

bind-key -T copy-mode-vi Enter                  send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi Escape                 send-keys -X clear-selection
bind-key -T copy-mode-vi Space                  send-keys -X begin-selection
bind-key -T copy-mode-vi \#                     send-keys -FX search-backward "#{copy_cursor_word}"
bind-key -T copy-mode-vi \$                     send-keys -X end-of-line
bind-key -T copy-mode-vi \%                     send-keys -X next-matching-bracket
bind-key -T copy-mode-vi *                      send-keys -FX search-forward "#{copy_cursor_word}"
bind-key -T copy-mode-vi ,                      send-keys -X jump-reverse
bind-key -T copy-mode-vi /                      command-prompt -T search -p "(search down)" { send-keys -X search-forward "%%" }
bind-key -T copy-mode-vi 0                      send-keys -X start-of-line
bind-key -T copy-mode-vi 1                      command-prompt -N -I 1 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 2                      command-prompt -N -I 2 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 3                      command-prompt -N -I 3 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 4                      command-prompt -N -I 4 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 5                      command-prompt -N -I 5 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 6                      command-prompt -N -I 6 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 7                      command-prompt -N -I 7 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 8                      command-prompt -N -I 8 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi 9                      command-prompt -N -I 9 -p (repeat) { send-keys -N "%%" }
bind-key -T copy-mode-vi :                      command-prompt -p "(goto line)" { send-keys -X goto-line "%%" }
bind-key -T copy-mode-vi \;                     send-keys -X jump-again
bind-key -T copy-mode-vi ?                      command-prompt -T search -p "(search up)" { send-keys -X search-backward "%%" }
bind-key -T copy-mode-vi A                      send-keys -X append-selection-and-cancel
bind-key -T copy-mode-vi B                      send-keys -X previous-space
bind-key -T copy-mode-vi D                      send-keys -X copy-pipe-end-of-line-and-cancel
bind-key -T copy-mode-vi E                      send-keys -X next-space-end
bind-key -T copy-mode-vi F                      command-prompt -1 -p "(jump backward)" { send-keys -X jump-backward "%%" }
bind-key -T copy-mode-vi G                      send-keys -X history-bottom
bind-key -T copy-mode-vi H                      send-keys -X top-line
bind-key -T copy-mode-vi J                      send-keys -X scroll-down
bind-key -T copy-mode-vi K                      send-keys -X scroll-up
bind-key -T copy-mode-vi L                      send-keys -X bottom-line
bind-key -T copy-mode-vi M                      send-keys -X middle-line
bind-key -T copy-mode-vi N                      send-keys -X search-reverse
bind-key -T copy-mode-vi P                      send-keys -X toggle-position
bind-key -T copy-mode-vi T                      command-prompt -1 -p "(jump to backward)" { send-keys -X jump-to-backward "%%" }
bind-key -T copy-mode-vi V                      send-keys -X select-line
bind-key -T copy-mode-vi W                      send-keys -X next-space
bind-key -T copy-mode-vi X                      send-keys -X set-mark
bind-key -T copy-mode-vi ^                      send-keys -X back-to-indentation
bind-key -T copy-mode-vi b                      send-keys -X previous-word
bind-key -T copy-mode-vi e                      send-keys -X next-word-end
bind-key -T copy-mode-vi f                      command-prompt -1 -p "(jump forward)" { send-keys -X jump-forward "%%" }
bind-key -T copy-mode-vi g                      send-keys -X history-top
bind-key -T copy-mode-vi h                      send-keys -X cursor-left
bind-key -T copy-mode-vi j                      send-keys -X cursor-down
bind-key -T copy-mode-vi k                      send-keys -X cursor-up
bind-key -T copy-mode-vi l                      send-keys -X cursor-right
bind-key -T copy-mode-vi n                      send-keys -X search-again
bind-key -T copy-mode-vi o                      send-keys -X other-end
bind-key -T copy-mode-vi q                      send-keys -X cancel
bind-key -T copy-mode-vi r                      send-keys -X refresh-from-pane
bind-key -T copy-mode-vi t                      command-prompt -1 -p "(jump to forward)" { send-keys -X jump-to-forward "%%" }
bind-key -T copy-mode-vi v                      send-keys -X rectangle-toggle
bind-key -T copy-mode-vi w                      send-keys -X next-word
bind-key -T copy-mode-vi z                      send-keys -X scroll-middle
bind-key -T copy-mode-vi \{                     send-keys -X previous-paragraph
bind-key -T copy-mode-vi \}                     send-keys -X next-paragraph
bind-key -T copy-mode-vi MouseDown1Pane         select-pane
bind-key -T copy-mode-vi MouseDrag1Pane         select-pane \; send-keys -X begin-selection
bind-key -T copy-mode-vi MouseDragEnd1Pane      send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi WheelUpPane            select-pane \; send-keys -X -N 5 scroll-up
bind-key -T copy-mode-vi WheelDownPane          select-pane \; send-keys -X -N 5 scroll-down
bind-key -T copy-mode-vi DoubleClick1Pane       select-pane \; send-keys -X select-word \; run-shell -d 0.3 \; send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi TripleClick1Pane       select-pane \; send-keys -X select-line \; run-shell -d 0.3 \; send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi BSpace                 send-keys -X cursor-left
bind-key -T copy-mode-vi Home                   send-keys -X start-of-line
bind-key -T copy-mode-vi End                    send-keys -X end-of-line
bind-key -T copy-mode-vi NPage                  send-keys -X page-down
bind-key -T copy-mode-vi PPage                  send-keys -X page-up
bind-key -T copy-mode-vi Up                     send-keys -X cursor-up
bind-key -T copy-mode-vi Down                   send-keys -X cursor-down
bind-key -T copy-mode-vi Left                   send-keys -X cursor-left
bind-key -T copy-mode-vi Right                  send-keys -X cursor-right
bind-key -T copy-mode-vi M-x                    send-keys -X jump-to-mark
bind-key -T copy-mode-vi C-b                    send-keys -X page-up
bind-key -T copy-mode-vi C-c                    send-keys -X cancel
bind-key -T copy-mode-vi C-d                    send-keys -X halfpage-down
bind-key -T copy-mode-vi C-e                    send-keys -X scroll-down
bind-key -T copy-mode-vi C-f                    send-keys -X page-down
bind-key -T copy-mode-vi C-h                    send-keys -X cursor-left
bind-key -T copy-mode-vi C-j                    send-keys -X copy-pipe-and-cancel
bind-key -T copy-mode-vi C-u                    send-keys -X halfpage-up
bind-key -T copy-mode-vi C-v                    send-keys -X rectangle-toggle
bind-key -T copy-mode-vi C-y                    send-keys -X scroll-up
bind-key -T copy-mode-vi C-Up                   send-keys -X scroll-up
bind-key -T copy-mode-vi C-Down                 send-keys -X scroll-down

# set-option -g utf8 on
# set-option -g status-utf8 on
# set-option -as terminal-overrides ",*:UTF-8"
set -g default-terminal "xterm-kitty"

set -ga terminal-overrides ',xterm-kitty:RGB,*:Ss=\E[6 q:Se=\E[6 q'
set -as terminal-features ',xterm-kitty:RGB,*:Ss=\E[6 q:Se=\E[6 q'
set -g status-position top

set -g @cursor-style vertical-bar
setw -g @cursor-style vertical-bar

set -g prefix C-t

set -g base-index         1     # 窗口编号从 1 开始计数
set -g display-panes-time 10000 # PREFIX-Q 显示编号的驻留时长，单位 ms
set -g mouse              off    # 开启鼠标
set -g pane-base-index    1     # 窗格编号从 1 开始计数
set -g renumber-windows   on    # 关掉某个窗口后，编号重排

setw -g allow-rename      off   # 禁止活动进程修改窗口名
setw -g automatic-rename  off   # 禁止自动命名新窗口
setw -g mode-keys         vi    # 进入复制模式的时候使用 vi 键位（默认是 EMACS）

bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k  select-pane -U
bind -n M-l select-pane -R

bind -n M-a previous-window
bind -n M-f next-window 

bind r split-window -h -c "#{pane_current_path}"
bind d split-window -v -c "#{pane_current_path}"

bind -n M-n new-window -c "#{pane_current_path}"

bind -n M-p display-popup -d "#{pane_current_path}" -E

bind x kill-pane
bind X kill-window

set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.config/tmux/plugins/'

# List of plugins

# 插件管理器
set -g @plugin 'tmux-plugins/tpm'
# 更好的默认选项
set -g @plugin 'tmux-plugins/tmux-sensible'
# 持续使用的键绑定
set -g @plugin 'alexwforsythe/tmux-which-key'
# 主题
# set -g @plugin "nordtheme/tmux"
# set -g @plugin 'egel/tmux-gruvbox'
set -g @plugin 'catppuccin/tmux#v2.1.3' # See https://github.com/catppuccin/tmux/tags for additional tags
# 会话管理和自动恢复会话
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# 插件配置
set -g @resurrect-strategy-nvim 'session'
set -g @continuum-restore 'on'
# set -g @tmux-gruvbox 'dark256' # or 'dark256', 'light', 'light256'

# <<--< Status line >-->>
set -g @catppuccin_flavor "mocha"
set -g @catppuccin_status_background "default"
set -g @catppuccin_window_status_style "custom"
set -ogq @catppuccin_status_left_separator ""
set -ogq @catppuccin_status_right_separator ""
set-option -g status-interval 1

# Left modules

set -g @catppuccin_uptime_icon ""
set -g status-left ""
set -g status-left-length 25
set -g status-left "#[bg=#{@thm_peach},fg=#{@thm_mantle}#{?client_prefix, bold] PREFIX #[bg=#{@thm_mantle}]#[fg=#{@thm_peach}],#[fg=#{@thm_mantle}]#{?#{==:#{pane_mode},copy-mode},#[bg=#{@thm_mauve}]#[fg=#{@thm_mantle} bold] V-COPY #[bg=#{@thm_mantle}]#[fg=#{@thm_mauve}],#[bg=#{@thm_blue},fg=#{@thm_mantle}, bold] NORMAL #[bg=#{@thm_mantle}]#[fg=#{@thm_blue}]}}"
set -ga status-left "#[fg=#{@thm_subtext_0} nobold] #{E:@catppuccin_status_uptime}"

# Center modules
set -g status-justify "absolute-centre"
set -g @catppuccin_window_number "#[bg=#{@thm_mantle},fg=#{@thm_surface_0}] #[bg=#{@thm_mantle},fg=#{@thm_overlay_2}]#I#[bg=#{@thm_mantle},fg=#{@thm_overlay_2}]:"
set -g @catppuccin_window_current_number "#[bg=#{@thm_mantle},fg=#{@thm_subtext_0}]#[bg=#{@thm_subtext_0},fg=#{@thm_mantle} bold] #I #[bg=#{@thm_surface_0},fg=#{@thm_subtext_0}]"
set -g @catppuccin_window_text_color "#{@thm_mantle}"
set -g @catppuccin_window_text "#[fg=#{@thm_overlay_2}]#{?#{!=:#{window_name},}, #W,}#[bg=#{@thm_mantle},fg=#{@thm_surface_0}] "
set -g @catppuccin_window_current_text_color "#{@thm_surface_0}"
set -g @catppuccin_window_current_text "#{?#{!=:#{window_name},}, #W,} #[bg=#{@thm_mantle},fg=#{@thm_surface_0}]"

# Right modules
set -g status-right ""
set -g status-right "#[bg=#{@thm_mantle},fg=#{@thm_peach}#{?client_prefix,]#[bg=#{@thm_peach}]#[fg=#{@thm_mantle} bold] #S ,#[fg=#{@thm_mantle}]#{?#{==:#{pane_mode},copy-mode},#[bg=#{@thm_mantle}]#[fg=#{@thm_mauve}]#[bg=#{@thm_mauve}]#[fg=#{@thm_mantle} bold] #S ,#[bg=#{@thm_mantle},fg=#{@thm_blue},]#[bg=#{@thm_blue}]#[fg=#{@thm_mantle} bold] #S }}"

run '~/.config/tmux/plugins/tpm/tpm'

